-   [Train the Intent Model](#AppendixF:ClarifyingQuestionAsker-TraintheIntentModel)
-   [Check Discriminative Phrases](#AppendixF:ClarifyingQuestionAsker-CheckDiscriminativePhrases)
-   [Configure Dashboard CQA Parameters](#AppendixF:ClarifyingQuestionAsker-ConfigureDashboardCQAParameters)
The Clarifying Question Asker (CQA) module asks a clarifying question when Amelia evaluates a user utterance, compares the utterance to two intents, and finds ambiguity with the user utterance and the two intents. The clarifying questions helps Amelia decide which intent is satisfied by the utterance. The module also can ask clarifying questions to determine which domain should respond to an utterance.
For example, for an intent to open a savings account and another to open a checking account, a user utterance, “I want to open an account” would lead Amelia to ask a clarifying question, “What type of account do you want to open?” or "Do you want to open a savings account or checking account?" In the latter question, one domain might be configured to handle savings account interactions while another domain is used for checking account interactions.
The clarifying question is defined and enabled in the intent training process.
Each intent includes discriminative phrases, for example, checking account or reinstating policy. These phrases are generated in training an intent model. When Amelia detects ambiguity between two intents, she uses these phrases to create the clarifying question. In the example above, `checking account` for the checking account intent and `savings account` for the savings account intent would be the discriminative phrases. The clarifying question using these phrases would be, “Are you talking about a `savings account` or `checking account`?”
Three steps implement the CQA functionality:
1.  Train the intent model using calibration and an out of domain classifier
2.  Check discriminative phrases generated by training
3.  Configure CQA parameters with the Dashboard
# Train the Intent Model
Because Amelia uses intent classifier scores to detect ambiguity, scores must be calibrated using an out of domain classifier to eliminate negative utterances.
On the Train tab, select `Softmax` from the Calibrate confidence scores dropdown list. Then toggle on the `Extract key phrases` and `Use out-of-domain classifier` settings. The Train tab is visible in a number of places in Amelia’s administration pages, primarily in the Amelia Trainer workspaces but also from the Process Knowledge workspace while creating BPNs.
![](attachments/11939776/11939786.png)
Figure. CQA Settings for Intent Model Training
# Check Discriminative Phrases
When training of the intent model is complete, open the two intents to check the discriminative phrases Amelia created during training. The phrases are in the Intents keywords and phrases section of the workspace.
> [!warning]  
>
> Discriminative phrases are displayed in decreasing order of importance. If needed, edit automatically generated phrases and add action phrases placed earlier or later in order, as needed.

![](attachments/11939776/11939777.png)
Figure. Edit CQA Discriminative Phrases for Intents
Action phrases also can be added in the The user wants to section of the intent workspace. For example, an action phrase, reset my password would have Amelia ask, “Do you want me to reset your password?”
# Configure Dashboard CQA Parameters
Two additional parameters can be used to configure CQA when Amelia encounters ambiguity in a user utterance. The Out-Of-Domain Threshold and Top-Two-Intent-Threshold parameters are set in the Edit CQA Params tab in the Dashboard workspace, part of the Amelia Trainer workspaces in Amelia’s administration pages.
To trigger the CQA module, two conditions need to be met:
-   The utterance should be in-domain, for example, the out of domain probability score from Amelia is less than the Out-Of-Domain-Threshold parameter.
-   The confidence scores of the top two intents should be close, specifically, the difference should be lesser than the Top-Two-Intent-Threshold parameter.
Confidence scores are generated for each intent when an utterance is classified by an intent classifier. The CQA module looks at how closely the confidence scores of the top two intents are to each other. An ambiguity is detected, and the CQA module is triggered, if the difference between the intent with the highest confidence score and the second-best intent confidence score is less than the Top-Two-Intent-Threshold parameter and the utterance is in domain. If the Top-Two-Intent-Threshold is set to 3, for example, and the difference between the two intent confidence scores is 2, Amelia detects an ambiguity and triggers the CQA module.
Confidence scores for utterances can be tested with the Predict workspace, also part of the Amelia Trainer workspaces in Amelia’s administration pages. In this example, the utterance, “I want to enroll” generates results under the CQA tab with a variety of scores.
![](attachments/11939776/25462271.png)
Figure. Predict Workspace with CQA Scores
These CQA scores can be used as guidelines to override the default CQA module parameters. The NLU Settings tab in the Amelia Trainer Dashboard workspace has parameter settings which can be set in response to the CQA scores generated by utterances in the Predict workspace. CQA also can disambiguate utterances to select the appropriate domain to respond.
![](attachments/11939776/25462268.png)
Figure. CQA Parameters in NLU Settings Tab in the Dashboard Workspace
Table. CQA Parameters in NLU Settings Tab

| Setting | Description |
| ----|----|
| Enable Intent CQA | When selected, enable clarifying question asking (CQA) for intents in this domain |
| In-Domain Threshold | If the in-domain score is less than this value, no intent will be predicted. |
| Intent Ambiguity Threshold | If the difference in scores of the top two intents is less than this value, the input utterance is considered intent ambiguous. |
| CQA Intent Threshold | If the top intent score is less than this value, CQA will be ignored. |
| Enable Domain CQA | When selected,;enable clarifying question asking (CQA) for Domain ambiguity. Domains must be set to at least allow switching in, as described in the Domains configuration page. |
| Domain Ambiguity Threshold | If the difference in scores of the top two domains is less than this value, the input utterance is considered domain ambiguous. |
| CQA Domain Threshold | If the top domain score is less than this value, CQA will be ignored. |

## Attachments:
![](images/icons/bullet_blue.gif) [image2018-11-20_16-16-27.png](attachments/11939776/11939777.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_14-34-36.png](attachments/11939776/11939778.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_13-7-4.png](attachments/11939776/11939779.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_13-5-14.png](attachments/11939776/11939780.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_13-4-12.png](attachments/11939776/11939781.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_12-49-28.png](attachments/11939776/11939782.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_12-47-32.png](attachments/11939776/11939783.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_12-17-14.png](attachments/11939776/11939784.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_11-58-53.png](attachments/11939776/11939785.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_11-52-51.png](attachments/11939776/11939786.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_11-50-31.png](attachments/11939776/11939787.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2018-11-9_11-40-33.png](attachments/11939776/11939788.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2019-10-29_10-51-1.png](attachments/11939776/25462268.png) (image/png)  
![](images/icons/bullet_blue.gif) [image2019-10-29_10-57-1.png](attachments/11939776/25462271.png) (image/png)  

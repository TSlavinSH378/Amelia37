Graphs can be displayed in Amelia's conversation in the custom user interface. Data is defined with a JSON name:value structure in a BPN Script task then sent with an integration message to the interface.
> [!warning]  
>
> Small pie and small timeline graphs in the chat notes area must appear in pairs. For example, while one small pie chart cannot display in the chat notes area, a small pie chart and a small timeline can display. Large graphs do not have to appear in pairs when displayed in the chat notes area.

# Graph Types
The types of graphs available include horizontal and vertical bar charts, timeline graphs, pie charts, metrics charts, and table charts. Large and small charts can appear in the chat notes area, on the right side of the screen. Small graphs cannot appear in the conversation chat log area.
![](attachments/20809637/20809639.jpg)
Figure. Graph Types and Available Chat Locations
The different available graphs and where they can appear also can be presented as a table.
Table. Graph Types and Available Chat Locations
<table class="wrapped confluenceTable">
<tbody>
<tr class="header">
<th class="confluenceTh"><br />
</th>
<th colspan="2" class="confluenceTh" style="text-align: center;">Locations</th>
</tr>
<tr class="odd">
<th class="confluenceTh">Graph Type</th>
<th class="confluenceTh" style="text-align: center;">Chat Log</th>
<th class="confluenceTh" style="text-align: center;">Chat Notes</th>
</tr>
&#10;<tr class="odd">
<td class="confluenceTd"><strong>Horizontal Bar</strong></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397019.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td colspan="3" class="confluenceTd"><strong>Vertical Bar</strong></td>
</tr>
<tr class="odd">
<td class="confluenceTd"> Large with Multiple Series</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td class="confluenceTd"> Large with Single Series</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="odd">
<td class="confluenceTd"> Small Vertical Bars</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397019.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td colspan="3" class="confluenceTd"><strong>Pie</strong></td>
</tr>
<tr class="odd">
<td class="confluenceTd"> Large Pie</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td class="confluenceTd"> Small Pie</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397019.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="odd">
<td class="confluenceTd"> Side Pie</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397019.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td colspan="3" class="confluenceTd"><strong>Timeline</strong></td>
</tr>
<tr class="odd">
<td class="confluenceTd"> Large with Multiple Series</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td class="confluenceTd"> Large with Single Series</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="odd">
<td class="confluenceTd"> Small Timeline</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397019.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td colspan="3" class="confluenceTd"><strong>Metrics</strong></td>
</tr>
<tr class="odd">
<td class="confluenceTd"> Large</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="even">
<td class="confluenceTd"> Small</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397019.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="odd">
<td colspan="3" class="confluenceTd"><strong>Table</strong></td>
</tr>
<tr class="even">
<td class="confluenceTd">Basic</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
</tr>
<tr class="odd">
<td class="confluenceTd">Popup</td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397024.png" /></p>
</div></td>
<td class="confluenceTd" style="text-align: center;"><div class="content-wrapper">
<p><img src="attachments/20809637/23397019.png" /></p>
</div></td>
</tr>
</tbody>
</table>
# Code Structure for Graphs
Because graphs can appear in the chat log, as part of a conversation, or in a chat note to the right of a conversation, there are some variations in the structure of code used to display graphs.
> [!info]  
>
> Every type of graph also has unique JSON name:value definitions, as shown in the pages which define each graph. Many of these definitions are easy to understand by reading the code examples in the same pages.

## Message and Payload Definitions
Every graph definition includes code that defines the message and payload code that specifies the interface details. The JSON message and payload code block is sent in a message to the custom user interface.
There are at least two ways to organize the code used to define a graph. One approach is to create a single block of Groovy and JSON code as a variable and pass the variable to the message service. Toggle the Expand Source link to view code.
**Message and Payload Code are Mixed** Expand source
``` groovy
def jsonString = '''
    {
        "action": "addChatNotesIntegration",
        "componentType": "ChatNote",
        "header": "Updated Header",
        "payload": [{
            "component": "ChatNote",
            "title": "Chat Note A",
            "actionProcess": {
                "actionName": "edit-chat-note-B",
                "actionArguments": {
                    "section": "image",
                    "testVar": "some variable"
                },
                "actionMessage": "Edit the section"
            },
            "subcomponents": [{
                "subcomponent": "Markup",
                "markupType": "TableGraph",
                "label": "Table Graph",
                "src": {
                    "title": "Account Balance",
                    "columns": ["month", "income"],
                    "rows": [
                        [{
                            "name": "Mar",
                            "value": "03"
                        }, {
                            "name": "$5,423",
                            "value": "5423"
                        }],
                        [{
                            "name": "Feb",
                            "value": "02"
                        }, {
                            "name": "$3,123",
                            "value": "3123"
                        }]
                    ]
                }
            }]
        }]
    }
    '''
messageService.sendIntegrationMessage(jsonString)
```
A second approach pulls out the subcomponent definitions as a single variable then references the variable in a block of code within the message definition code. Toggle the Expand Source link to view code.
**Message and Payload Code are Split** Expand source
``` groovy
def tableGraph = '''
    {
        "subcomponent": "Markup",
        "markupType": "TableGraph",
        "label": "Table Graph",
        "src": {
            "title": "Account Balance",
            "columns": ["month", "income"],
            "rows": [
                [{
                    "name": "Mar",
                    "value": "03"
                }, {
                    "name": "$5,423",
                    "value": "5423"
                }],
                [{
                    "name": "Feb",
                    "value": "02"
                }, {
                    "name": "$3,123",
                    "value": "3123"
                }]
            ]
        }
    }
    '''
def jsonString = '''
    {
        "action": "addChatNotesIntegration",
        "componentType": "ChatNote",
        "header": "Updated Header",
        "payload": [{
            "component": "ChatNote",
            "title": "Chat Note A",
            "actionProcess": {
                "actionName": "edit-chat-note-B",
                "actionArguments": {
                    "section": "image",
                    "testVar": "some variable"
                },
                "actionMessage": "Edit the section"
            },
            "subcomponents": [''' + tableGraph + ''']
        }]
    }
    '''
messageService.sendIntegrationMessage(jsonString)
```
## Common Code
Graphs are designed with a JSON structure. Every graph has most or all of these elements in common.
Table. Common Code Structure Elements
<table class="wrapped confluenceTable">
<tbody>
<tr class="header">
<th class="confluenceTh">JSON Name Element</th>
<th class="confluenceTh">Description</th>
</tr>
&#10;<tr class="odd">
<td class="confluenceTd">action</td>
<td class="confluenceTd">Defines whether or not the JSON structure is displayed in the chat log or chat notes.<br />
addChatMessage – the structure is to display in the chat log<br />
addChatNotesIntegration – the structure is to display in the chat notes</td>
</tr>
<tr class="even">
<td class="confluenceTd">payload</td>
<td class="confluenceTd">Contains the full definition of a graph including metadata</td>
</tr>
<tr class="odd">
<td class="confluenceTd">componentType</td>
<td class="confluenceTd">For chat log graphs, the MessageIntegration setting defines the payload type<br />
For chat note graphs, the ChatNote setting defines the type of action</td>
</tr>
<tr class="even">
<td class="confluenceTd">actionProcess</td>
<td class="confluenceTd"><p>Optional. If users can edit data in a chat note, actionProcess defines details needed.</p>
<div class="table-wrap">
<pre class="table"><code>| Element | Description |
| ----|----|
| actionName | Name of the BPN to call to handle any edits to the chat note |
| actionLabel | Short description of the purpose for editing a chat note |
| actionArguments | Optional. Define variables passed to the actionName BPN. |
| actionMessage | Describe what happens when pencil edit icon is clicked |</code></pre>
</div></td>
</tr>
<tr class="odd">
<td class="confluenceTd">subcomponent</td>
<td class="confluenceTd">Contains the detailed definition of the graph</td>
</tr>
<tr class="even">
<td class="confluenceTd"><p>subcomponentType<br />
markupType</p></td>
<td class="confluenceTd"><p>For chat log graphs, subcomponentType defines the type of data being sent to the interface<br />
For chat note graphics, markupType defines the type of data being sent to the interface</p>
<p>Graphs use TimeSelector for non-table graphs and TableData or TableGraph settings for table charts</p></td>
</tr>
<tr class="odd">
<td class="confluenceTd">metricComponents</td>
<td class="confluenceTd">For non-table graphs, defines heading, data, and other graph details</td>
</tr>
<tr class="even">
<td class="confluenceTd">graphType</td>
<td class="confluenceTd">For non-table graphs, defines the type of data. Settings are bar, metrics, metric, timeline, and pie. The metrics setting applies to a metricComponents definition while the other settings apply to the definition of individual parts of a graph within a metricsComponents object.</td>
</tr>
</tbody>
</table>
## Chat Log Code
In addition to the common code structure, graphs displayed in the chat log have unique code elements.
Table. Chat Log Code Structure Elements

| JSON Name Element | Description |
| ----|----|
| subcomponentProps | Defines properties of subcomponents for a payload |

## Chat Note Code
In addition to the common code structure, graphs displayed in chat notes have unique code elements.
Table. Chat Note Code Structure Elements

| JSON Name Element | Description |
| ----|----|
| header | Displays text for the chat note heading |
| component | The ChatNote setting defines a payload as a chat note |
| title | Text displayed within a payload as part of a chat note |
| styles | Optional. Set labelSize and labelWeight for titles within a payload displayed within a chat note. |
| markupProps | Defines properties of a subcomponent |

